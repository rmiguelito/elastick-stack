filter {
	if [message] =~ /.*Gravação Finalizada: EV_RECORDSTOP.*/ {
		grok {
			match => [ 
				"message", "%{TIMESTAMP_ISO8601:[@metadata][timestamp]}.*port:(?<porta>[0-9]+).*Gravação Finalizada: EV_RECORDSTOP \| (?<identificador_chamada>[0-9_]+)\s*$"
			] 
		}

		mutate {
			add_field => [ "event_type", "desligamento" ]
			add_tag => ["finalizouAtendimento"]
			add_tag => ["processado"]
			convert => { "porta" => "integer"}
		}
	}
}