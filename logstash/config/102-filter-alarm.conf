filter {
	if [message] =~ /.*ALARM_[A-Z]+:.*/ {
		grok {
			match => [ 
				"message", "%{TIMESTAMP_ISO8601:[@metadata][timestamp]}.*port:(?<porta>[0-9]+).*ALARM_(?<alarm_nome>[A-Z]+): (?<alarm_descricao>[^-]+)- Placa : (?<placa>[0-9]+)$"
			] 
		}

		mutate {
			add_field => [ "event_type", "alarm" ]
			add_tag => ["processado"]
			convert => { 
					"porta" => "integer"
					"placa" => "integer"
			}
		}
	}
}