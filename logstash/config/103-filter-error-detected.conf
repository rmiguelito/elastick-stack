filter {
	if [message] =~ /.*EV_ERRORDETECTED.*/ {
		grok {
			match => [ 
				"message", "%{TIMESTAMP_ISO8601:[@metadata][timestamp]}.*port:(?<porta>[0-9]+).*EV_ERRORDETECTED - PLACA: (?<placa>[0-9]+) - ERRO: (?<erro>[0-9]+)$"
			] 
		}

		mutate {
			add_field => [ "event_type", "error_detected" ]
			add_tag => ["processado"]
			convert => { 
					"porta" => "integer"
					"placa" => "integer"
			}
		}
	}
}